/**
 * sheets - Handle your presentation logic like CSS, but with Javascript.
 * @version v0.0.1
 * @link https://github.com/zackbrown/sheets
 * @license MPL v2.0
 */
"use strict";var tsSheetsModule=angular.module("ts.sheets",[]);angular.module("ts.sheets").provider("$media",function(){function e(e){angular.forEach(e,function(e){console.log("mutation observed",e),"attributes"===e.type&&console.warn("ensure that record.target is the parent node, not a child node",e),o(e.target)})}function n(){c=!0,r()}function t(){if(!c)return s;var e=[];if(angular.forEach(f,function(n){n.conditionFn()&&e.push(n)}),!e.length)throw new Error("$media assumes at least one media query will be matched (by default this is 'xs').");return e.sort(function(e,n){return n.priority-e.priority}),c=!1,s=e}function r(){var e=Object.keys(v);angular.forEach(e,function(e){o(v[e])})}function i(e,n){var t=!Array.isArray(e)&&Object.keys(e);return t&&t.length?i(e[t[0]],++n):n}function o(e){var n=e.data(a),r=p[n],o=t();angular.forEach(r,function(n){var t,r=i(n,0);if(2===r)t=n;else{if(3!==r)throw new Error("Malformed Sheet.  Object depth of 2 or 3 expected.  Actual depth was "+r);var a=!1;angular.forEach(o,function(e){a||n[e.name]&&(a=!0,t=n[e.name])})}if(t){var u=Object.keys(t);angular.forEach(u,function(n){var r=Object.keys(t[n]),i=e[0].querySelectorAll(n);angular.forEach(i,function(e){angular.forEach(r,function(r){var i=t[n][r];m[r](e,i)})})})}})}var a="$$sheetId",u={attributes:!0,childList:!0},c=!0,s=[],d=function(e,n,t){null!==e&&"undefined"!=typeof e&&(e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent?e.attachEvent("on"+n,t):e["on"+n]=t)},f=[],h={},l={},p={},v={},m={},y={},g=this.$registerMediaQuery=function(e,n,t){f[t]={name:e,conditionFn:n,priority:t},h[e]={name:e,conditionFn:n,priority:t}},$=this.$registerFieldHandler=function(e,n){m[e]=n},E={$sheet:function(e,n){void 0!==l[e]&&console.warn("Sheet name '"+e+"' is already defined.  The latest declaration will overwrite previous declarations."),l[e]=n},$applySheet:function(n,t){n.data(a,n.data(a)||Math.random());var r=n.data(a),i=l[t];if(void 0===i)throw new Error("Sheet '"+t+"' is undefined.  Sheets must be defined using $media.$sheet before they can be applied with ts-sheet.");v[r]=n,p[r]=p[r]||[],p[r].push(i);var c=y[r]=y[r]||new MutationObserver(e);c.observe(n[0],u),o(n)},$clearSheets:function(e,n){var t=e.data(a);delete l[n],delete p[t],delete v[t],y[t].disconnect()},$query:function(e){return h[e].conditionFn()}};this.$get=["$window",function(e){d(e,"resize",n);var t=[{name:"xs",conditionFn:function(){return!0},priority:0},{name:"sm",conditionFn:function(){return e.innerWidth>=768},priority:1},{name:"md",conditionFn:function(){return e.innerWidth>=992},priority:2},{name:"lg",conditionFn:function(){return e.innerWidth>=1200},priority:3}],r=[];return angular.forEach(t,function(e){g(e.name,e.conditionFn,e.priority)}),angular.forEach(r,function(e){$(e.field,e.handlerFn)}),E}]}),angular.module("ts.sheets").directive("tsSheet",["$media",function(e){return{restrict:"A",scope:!1,compile:function(){return{post:function(n,t,r){n.$$postDigest(function(){e.$applySheet(t,r.tsSheet)}),n.$on("$destroy",function(){e.$clearSheets(t,r.tsSheet)})}}}}}]);